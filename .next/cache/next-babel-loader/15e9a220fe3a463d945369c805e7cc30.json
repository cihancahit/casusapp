{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport dynamic from \"next/dynamic\";\nimport { useState, useEffect } from \"react\";\nimport Swal from \"sweetalert2\";\nvar PWAPrompt = dynamic(function () {\n  return import(\"react-ios-pwa-prompt\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-ios-pwa-prompt\")];\n    },\n    modules: [\"react-ios-pwa-prompt\"]\n  }\n});\n\nvar AddAppButton = function AddAppButton() {\n  var _useState = useState(false),\n      isAlreadyPWA = _useState[0],\n      setIsAlreadyPWA = _useState[1];\n\n  var _useState2 = useState(false),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(false),\n      isiOS = _useState3[0],\n      setIsiOS = _useState3[1];\n\n  var _useState4 = useState(),\n      deferredPrompt = _useState4[0],\n      setDeferredPrompt = _useState4[1];\n\n  var _useState5 = useState(false),\n      showiOS = _useState5[0],\n      setShowiOS = _useState5[1];\n\n  useEffect(function () {\n    // https://stackoverflow.com/a/52695341\n    setIsAlreadyPWA(window.matchMedia(\"(display-mode: standalone)\").matches || window.navigator.standalone || document.referrer.includes(\"android-app://\"));\n    setIsiOS(/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream); // https://web.dev/customize-install/#beforeinstallprompt\n\n    window.addEventListener(\"beforeinstallprompt\", function (e) {\n      // Prevent the mini-infobar from appearing on mobile\n      e.preventDefault(); // Stash the event so it can be triggered later.\n\n      setDeferredPrompt(e);\n    });\n  });\n\n  var handleAddApp = function handleAddApp() {\n    setIsLoading(true);\n\n    if (isiOS) {\n      setShowiOS(true);\n    } else if (deferredPrompt) {\n      // https://web.dev/customize-install/#in-app-flow\n      // Show the install prompt\n      deferredPrompt.prompt(); // Wait for the user to respond to the prompt\n\n      deferredPrompt.userChoice.then(function () {\n        return setIsLoading(false);\n      });\n    } else {\n      Swal.fire(\"Oops...\", \"Can't add Drawphone as an app on this device. Try on your phone!\", \"error\").then(function () {\n        return setIsLoading(false);\n      });\n    }\n  };\n\n  return __jsx(React.Fragment, null, !isAlreadyPWA && __jsx(\"button\", {\n    className: \"btn-small btn-vertical\",\n    onClick: handleAddApp\n  }, isLoading ? \"Loading...\" : \"Add SpyGame as App\"), showiOS && __jsx(PWAPrompt, {\n    debug: true,\n    permanentlyHideOnDismiss: false,\n    onCancel: function onCancel() {\n      setShowiOS(false);\n      setIsLoading(false);\n    }\n  }));\n};\n\nexport default AddAppButton;","map":null,"metadata":{},"sourceType":"module"}